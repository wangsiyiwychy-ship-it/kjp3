<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‚¾åŠŸèƒ½æ•°æ®è¯ç‰©æŸ¥è¯¢ç³»ç»Ÿ</title>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .back-to-home {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-weight: 500;
        }

        .back-to-home:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .back-to-home i {
            margin-right: 8px;
        }

        .search-section {
            padding: 40px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .search-container {
            position: relative;
            max-width: 600px;
            margin: 0 auto;
        }

        .search-input {
            width: 100%;
            padding: 20px 60px 20px 25px;
            font-size: 18px;
            border: 2px solid #e9ecef;
            border-radius: 50px;
            outline: none;
            transition: all 0.3s ease;
            background: white;
        }

        .search-input:focus {
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: #4facfe;
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #3d8bfe;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e9ecef;
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .autocomplete-item {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 1px solid #f8f9fa;
            transition: background 0.2s ease;
        }

        .autocomplete-item:hover,
        .autocomplete-item.highlighted {
            background: #f8f9fa;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .drug-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .drug-english-name {
            color: #666;
            font-size: 0.9em;
        }

        .result-section {
            padding: 30px;
            display: none;
        }

        .drug-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 5px solid #4facfe;
        }

        .drug-title {
            color: #333;
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .drug-subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 25px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .info-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #4facfe;
        }

        .info-label {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .info-content {
            color: #555;
            line-height: 1.6;
            white-space: pre-line;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .no-results img {
            width: 100px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .search-tips {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #4facfe;
        }

        .search-tips h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .search-tips ul {
            color: #555;
            padding-left: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .search-section {
                padding: 30px 20px;
            }
            
            .search-input {
                font-size: 16px;
                padding: 15px 50px 15px 20px;
            }
            
            .search-btn {
                width: 38px;
                height: 38px;
            }
            
            .result-section {
                padding: 20px;
            }
            
            .drug-card {
                padding: 20px;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="back-to-home">
                <i class="fa fa-home"></i>è¿”å›ä¸»é¡µ
            </a>
            <h1>ğŸ©º è‚¾åŠŸèƒ½æ•°æ®è¯ç‰©æŸ¥è¯¢ç³»ç»Ÿ</h1>
            <p>ä¸“ä¸šè¯ç‰©æŸ¥è¯¢ï¼Œæ”¯æŒä¸­è‹±æ–‡æœç´¢ï¼Œäº†è§£è‚¾åŠŸèƒ½å¯¹è¯ç‰©ä½¿ç”¨çš„å½±å“</p>
        </div>

        <div class="search-section">
            <div class="search-container">
                <input type="text" id="searchInput" class="search-input" placeholder="è¯·è¾“å…¥è¯ç‰©ä¸­æ–‡åæˆ–è‹±æ–‡åè¿›è¡Œæœç´¢..." autocomplete="off">
                <button class="search-btn" onclick="performSearch()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
                <div id="autocompleteDropdown" class="autocomplete-dropdown"></div>
            </div>

            <div class="search-tips">
                <h3>ğŸ’¡ æœç´¢æç¤º</h3>
                <ul>
                    <li>æ”¯æŒä¸­æ–‡è¯ç‰©åç§°æœç´¢ï¼ˆå¦‚ï¼šé˜¿è«è¥¿æ—ã€é’éœ‰ç´ ï¼‰</li>
                    <li>æ”¯æŒè‹±æ–‡è¯ç‰©åç§°æœç´¢ï¼ˆå¦‚ï¼šAmoxicillinã€Penicillinï¼‰</li>
                    <li>è¾“å…¥å…³é”®è¯å³å¯è·å¾—ç›¸å…³å»ºè®®</li>
                    <li>ç‚¹å‡»æœç´¢ç»“æœæˆ–æŒ‰å›è½¦é”®æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</li>
                </ul>
            </div>
        </div>

        <div id="resultSection" class="result-section">
            <!-- æœç´¢ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
        </div>
    </div>

    <script>
        let drugsData = [];
        let autocompleteTimeout;

        // åŠ è½½è¯ç‰©æ•°æ®
        async function loadDrugsData() {
            try {
                const response = await fetch('./drugs_data.json');
                drugsData = await response.json();
                console.log('è¯ç‰©æ•°æ®åŠ è½½æˆåŠŸï¼Œå…±', drugsData.length, 'ç§è¯ç‰©');
            } catch (error) {
                console.error('åŠ è½½è¯ç‰©æ•°æ®å¤±è´¥:', error);
                // å¦‚æœæ— æ³•åŠ è½½JSONæ–‡ä»¶ï¼Œä½¿ç”¨å†…åµŒæ•°æ®
                loadEmbeddedData();
            }
        }

        // å†…åµŒæ•°æ®ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
        function loadEmbeddedData() {
            drugsData = [
                {
                    "chinese_name": "è‹„é’éœ‰ç´ ",
                    "english_name": "Benzylpenicillin (Penicillin G)",
                    "clinical_application": "æŠ—èŒè¯",
                    "normal_dosage": "æ¯æ—¥ 2.4ï½ 14.4g ï¼Œåˆ† 4ï½ 6 æ¬¡åº”ç”¨",
                    "pharmacokinetics": "åˆ†å­é‡ï¼ˆDaï¼‰ 334.4\nè›‹ç™½ç»“åˆç‡ï¼ˆ%ï¼‰ 60\nå°¿ä¸­åŸå‹è¯æ’æ³„ç‡ï¼ˆ%ï¼‰ 60~90\nåˆ†å¸ƒå®¹ç§¯ï¼ˆL/kgï¼‰ 0.3~0.42\nåŠè¡°æœŸï¼ˆhï¼‰ï¼šæ­£å¸¸/ESRF 0.5/10",
                    "drug_metabolism": "è‹„é’éœ‰ç´ åœ¨ä½“å†…å¾ˆå°‘ä»£è°¢ï¼Œåœ¨å°¿æ¶²ä¸­å¯å‘ç°é’éœ‰å™»å”‘é…¸è¡ç”Ÿç‰©ï¼ˆpenicilloic acid derivativeï¼‰ã€‚è‹„é’éœ‰ç´ èƒ½è¿…é€Ÿä»å°¿æ¶²æ’æ³„ï¼›å£æœå‰‚é‡çš„ 20% ä»¥è¯ç‰©åŸå‹ä»å°¿æ¶²æ’æ³„ï¼›è‚Œå†…æ³¨å°„å‰‚é‡çš„ 60% ï½ 90% ç»è‚¾æ¸…é™¤ï¼Œå¤šæ•°åœ¨1å°æ—¶å†…å®Œæˆï¼Œå…¶ä¸­ 10% é€šè¿‡è‚¾å°çƒæ»¤è¿‡ï¼Œ 90% é€šè¿‡è‚¾å°ç®¡åˆ†æ³Œã€‚è‚¾åŠŸèƒ½æ­£å¸¸æ—¶ï¼Œå¾ˆå°‘éƒ¨åˆ†ç»èƒ†æ±æ’æ³„ï¼Œè€Œè‚¾åŠŸèƒ½å—æŸæ—¶ï¼Œèƒ†æ±ä¸­çš„æµ“åº¦æ˜æ˜¾å‡é«˜ã€‚ä¸™ç£ºèˆ’ï¼ˆprobenecidï¼‰å¯æŠ‘åˆ¶è‚¾å°ç®¡çš„åˆ†æ³Œï¼Œè¿›è€Œå¢åŠ è‹„é’éœ‰ç´ çš„è¡€è¯æµ“åº¦ï¼Œå»¶é•¿åŠè¡°æœŸ",
                    "impaired_kidney_function_dosage": "20ï½ 50 ä¸è‚¾åŠŸèƒ½æ­£å¸¸æ—¶åŒå‰‚é‡\n10ï½ 20 0.6ï½ 2.4g ï¼Œæ¯6å°æ—¶1æ¬¡ï¼Œå–å†³äºæ„ŸæŸ“ä¸¥é‡ç¨‹åº¦[1]\n<10 0.6ï½ 1.2g ï¼Œæ¯6å°æ—¶1æ¬¡ï¼Œå–å†³äºæ„ŸæŸ“ä¸¥é‡ç¨‹åº¦[1]",
                    "renal_replacement_therapy_dosage": "APD/CAPD é€æå¯æ¸…é™¤ã€‚ä¸GFR<10ml/minæ—¶åŒå‰‚é‡\nHD é€æå¯æ¸…é™¤ã€‚ä¸GFR<10ml/minæ—¶åŒå‰‚é‡\nHDF/HFD é€æå¯æ¸…é™¤ã€‚ä¸GFR<10ml/minæ—¶åŒå‰‚é‡\nCAV/VVHD é€æå¯æ¸…é™¤ã€‚ä¸ GFR= 10ï½ 20ml / min æ—¶åŒå‰‚é‡",
                    "important_drug_interactions": "ä¸å…¶ä»–è¯ç‰©åˆç”¨çš„æ½œåœ¨é£é™©\nâ€¢ æœ¬è¯èƒ½å‡å°‘æ°¨ç”²è¶å‘¤ï¼ˆmethotrexateï¼‰çš„æ’æ³„",
                    "usage": "æº¶æ¶²é…åˆ¶ é™è„‰æ³¨å°„ï¼š600mg æº¶äº5ml æ³¨å°„ç”¨æ°´ä¸­\né™è„‰æ»´æ³¨ï¼š600mg è‡³å°‘æº¶äº 10ml 0.9% æ°¯åŒ–é’ æº¶æ¶²ä¸­\nè‚Œå†…æ³¨å°„ï¼š600mg æº¶äº1.6ml æ³¨å°„ç”¨æ°´ä¸­\nç”¨æ³• é™è„‰æ³¨å°„ï¼Œé™è„‰æ»´æ³¨ï¼Œè‚Œå†…æ³¨å°„\nè¾“æ³¨é€Ÿåº¦ é™è„‰æ³¨å°„ï¼š3~4åˆ†é’Ÿæˆ–ä»¥ä¸Šé™è„‰æ»´æ³¨ï¼š30~60åˆ†é’Ÿæˆ–ä»¥ä¸Š\næ³¨é‡Š é™è„‰ç»™è¯å‰‚é‡è¶…è¿‡ 1.2g æ—¶ï¼Œå¿…é¡»ç¼“æ…¢æ»´æ³¨ï¼Œæœ€å°é€Ÿåº¦ä¸º 300mg / min",
                    "other_information": "- é‡åº¦è‚¾åŠŸèƒ½å—æŸæ—¶çš„æœ€å¤§å‰‚é‡ï¼šæ¯æ—¥ 4.8g\n- 600mgè‹„é’éœ‰ç´ é’ å«1.68mmolé’ ï¼ˆè¯‘è€…æ³¨ï¼šæ¯1mgè‹„é’éœ‰ç´ é’ ç›¸å½“äº1670å•ä½é’éœ‰ç´ ï¼‰\n- 600mgè‹„é’éœ‰ç´ é’¾å«1.7mmolé’¾ï¼ˆè¯‘è€…æ³¨ï¼šæ¯1mgè‹„é’éœ‰ç´ é’¾ç›¸å½“äº1598å•ä½é’éœ‰ç´ ï¼‰\n- è‚¾åŠŸèƒ½å—æŸæ—¶ç¥ç»æ¯’æ€§å‘ç”Ÿç‡å¢åŠ ï¼ˆç™«ç—«å‘ä½œï¼‰\n- è‹„é’éœ‰ç´ æ²»ç–—å¯å¯¼è‡´å°¿è›‹ç™½å‡é˜³æ€§",
                    "references": "[1] Foster P,Gordon F,Holloway S. Drug dosage adjustment during continuous renal replacement therapy. Br J Int Care. April 1996; 120-124."
                },
                {
                    "chinese_name": "é˜¿è«è¥¿æ—",
                    "english_name": "Amoxicillin",
                    "clinical_application": "æŠ—èŒè¯",
                    "normal_dosage": "0.25ï½ 1g ï¼Œæ¯8å°æ—¶1æ¬¡ï¼ˆæœ€å¤§å‰‚é‡æ¯æ—¥ 6g ï¼Œæ²»ç–—å¿ƒå†…è†œç‚å¯è¾¾ 12g ï¼‰",
                    "pharmacokinetics": "åˆ†å­é‡ï¼ˆDaï¼‰ 365.4\nè›‹ç™½ç»“åˆç‡ï¼ˆ%ï¼‰ 20\nå°¿ä¸­åŸå‹è¯æ’æ³„ç‡ï¼ˆ%ï¼‰ 60\nåˆ†å¸ƒå®¹ç§¯ï¼ˆL/kgï¼‰ 0.3\nåŠè¡°æœŸï¼ˆhï¼‰ï¼šæ­£å¸¸/ESRFï¼ˆ1~1.5ï¼‰/ï¼ˆ7~20ï¼‰",
                    "drug_metabolism": "å°‘éƒ¨åˆ†é˜¿è«è¥¿æ—èƒ½ä»£è°¢æˆé’éœ‰å™»å”‘é…¸ï¼ˆpenicilloicacidï¼‰ï¼Œç»å°¿æ¶²æ’æ³„ã€‚çº¦ 60% çš„å£æœé˜¿è«è¥¿æ—é€šè¿‡è‚¾å°çƒæ»¤è¿‡å’Œè‚¾å°ç®¡åˆ†æ³Œåä»¥åŸå‹ä»å°¿æ¶²æ’æ³„ã€‚ä¸™ç£ºèˆ’ï¼ˆprobenecidï¼‰å¯å‡å°‘å…¶è‚¾æ’æ³„ã€‚æœ‰æŠ¥é“è®¤ä¸ºï¼Œæœ¬è¯åœ¨èƒ†æ±ä¸­çš„æµ“åº¦é«˜ï¼Œå¹¶å¯èƒ½é€šè¿‡ç²ªä¾¿æ’æ³„",
                    "impaired_kidney_function_dosage": "20ï½ 50 ä¸è‚¾åŠŸèƒ½æ­£å¸¸æ—¶åŒå‰‚é‡\n10~20 ä¸è‚¾åŠŸèƒ½æ­£å¸¸æ—¶åŒå‰‚é‡\n<10 0.25ï½ 1g ï¼Œæ¯8å°æ—¶1æ¬¡ï¼ˆå¿ƒå†…è†œç‚æ—¶æœ€å¤§å‰‚é‡ä¸ºæ¯æ—¥6gï¼‰",
                    "renal_replacement_therapy_dosage": "APD/CAPD ä¸è¢«é€ææ¸…é™¤ã€‚ä¸ GFR<10ml/min æ—¶åŒå‰‚é‡\nHD é€æå¯æ¸…é™¤ã€‚ä¸GFR<10ml/minæ—¶åŒå‰‚é‡\nHDF/HFD é€æå¯æ¸…é™¤ã€‚ä¸GFR<10ml/minæ—¶åŒå‰‚é‡\nCAV/VVHD é€æå¯æ¸…é™¤ã€‚ä¸è‚¾åŠŸèƒ½æ­£å¸¸æ—¶åŒå‰‚é‡",
                    "important_drug_interactions": "ä¸å…¶ä»–è¯ç‰©åˆç”¨çš„æ½œåœ¨é£é™©\nâ€¢ æœ¬è¯å¯å‡å°‘æ°¨ç”²è¶å‘¤ï¼ˆmethotrexateï¼‰\nçš„æ’æ³„ï¼Œå¢åŠ æ¯’æ€§é£é™©",
                    "usage": "æº¶æ¶²é…åˆ¶ é™è„‰ç»™è¯ï¼š0.25gè¯ç‰©æº¶äº 5mlæ³¨å°„ç”¨æ°´ä¸­\nè‚Œå†…æ³¨å°„ï¼š0.25g è¯ç‰©æº¶äº\n1.5ml æ³¨å°„ç”¨æ°´ä¸­ï¼›0.5g è¯\nç‰©æº¶äº 2.5ml æ³¨å°„ç”¨æ°´ä¸­ï¼›\n1gè¯ç‰©æº¶äº 2.5ml æ³¨å°„\nç”¨æ°´æˆ– 1% ç­èŒåˆ©å¤šå¡å› \nï¼ˆlidocaineï¼‰ä¸­\nç”¨æ³• å£æœï¼Œé™è„‰ç»™è¯ï¼Œè‚Œå†…æ³¨å°„\nè¾“æ³¨é€Ÿåº¦ ç¼“æ…¢é™è„‰æ³¨å°„ï¼ŒæŒç»­3~4åˆ†é’Ÿæˆ–ä»¥ä¸Š\né™è„‰æ»´æ³¨ï¼ŒæŒç»­ 30ï½ 60 åˆ†é’Ÿ\næ³¨é‡Š é™è„‰æ»´æ³¨ï¼šç”¨ 100ml5% è‘¡\nè„ç³–æº¶æ¶²æˆ– 0.9% æ°¯åŒ–é’ æº¶æ¶²ç¨€é‡Šåæ»´æ³¨\né™è„‰æ»´æ³¨æº¶æ¶²ä¸­è¯ç‰©çš„ç¨³å®š\næ€§å–å†³äºç¨€é‡Šå‰‚æˆåˆ†",
                    "other_information": "- æ¯å°ç“¶å¥¥çº³æ¬£ï¼ˆamoxilï¼‰å«é’  3.3mmol / g ï¼ˆè¯‘è€…æ³¨ï¼šå¥¥çº³æ¬£æ˜¯é˜¿è«è¥¿æ—çš„åˆ«åï¼‰\n- å‹¿ä¸æ°¨åŸºç³–è‹·ç±»ï¼ˆaminoglycosidesï¼‰æ··åˆåº”ç”¨",
                    "references": ""
                }
            ];
        }

        // åˆå§‹åŒ–åº”ç”¨
        async function init() {
            await loadDrugsData();
            setupEventListeners();
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            const searchInput = document.getElementById('searchInput');
            
            searchInput.addEventListener('input', handleSearchInput);
            searchInput.addEventListener('keydown', handleKeyDown);
            searchInput.addEventListener('focus', showAutocomplete);
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­è‡ªåŠ¨å®Œæˆ
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.search-container')) {
                    hideAutocomplete();
                }
            });
        }

        // å¤„ç†æœç´¢è¾“å…¥
        function handleSearchInput(e) {
            const query = e.target.value.trim();
            
            clearTimeout(autocompleteTimeout);
            
            if (query.length === 0) {
                hideAutocomplete();
                return;
            }
            
            autocompleteTimeout = setTimeout(() => {
                showAutocompleteSuggestions(query);
            }, 300);
        }

        // å¤„ç†é”®ç›˜äº‹ä»¶
        function handleKeyDown(e) {
            const dropdown = document.getElementById('autocompleteDropdown');
            const items = dropdown.querySelectorAll('.autocomplete-item');
            const highlighted = dropdown.querySelector('.autocomplete-item.highlighted');
            
            if (e.key === 'Enter') {
                e.preventDefault();
                if (highlighted) {
                    highlighted.click();
                } else {
                    performSearch();
                }
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                if (!highlighted && items.length > 0) {
                    items[0].classList.add('highlighted');
                } else if (highlighted && highlighted.nextElementSibling) {
                    highlighted.classList.remove('highlighted');
                    highlighted.nextElementSibling.classList.add('highlighted');
                }
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                if (highlighted && highlighted.previousElementSibling) {
                    highlighted.classList.remove('highlighted');
                    highlighted.previousElementSibling.classList.add('highlighted');
                }
            } else if (e.key === 'Escape') {
                hideAutocomplete();
            }
        }

        // æ˜¾ç¤ºè‡ªåŠ¨å®Œæˆå»ºè®®
        function showAutocompleteSuggestions(query) {
            const suggestions = searchDrugs(query, true); // åªè¿”å›å»ºè®®
            
            if (suggestions.length === 0) {
                hideAutocomplete();
                return;
            }
            
            const dropdown = document.getElementById('autocompleteDropdown');
            dropdown.innerHTML = '';
            
            suggestions.slice(0, 8).forEach(drug => {
                const item = document.createElement('div');
                item.className = 'autocomplete-item';
                item.innerHTML = `
                    <div class="drug-name">${drug.chinese_name}</div>
                    <div class="drug-english-name">${drug.english_name}</div>
                `;
                item.onclick = () => selectDrug(drug);
                dropdown.appendChild(item);
            });
            
            dropdown.style.display = 'block';
        }

        // æ˜¾ç¤ºè‡ªåŠ¨å®Œæˆ
        function showAutocomplete() {
            const query = document.getElementById('searchInput').value.trim();
            if (query.length > 0) {
                showAutocompleteSuggestions(query);
            }
        }

        // éšè—è‡ªåŠ¨å®Œæˆ
        function hideAutocomplete() {
            const dropdown = document.getElementById('autocompleteDropdown');
            dropdown.style.display = 'none';
        }

        // é€‰æ‹©è¯ç‰©
        function selectDrug(drug) {
            document.getElementById('searchInput').value = drug.chinese_name;
            hideAutocomplete();
            displayDrugResult(drug);
        }

        // æœç´¢è¯ç‰©
        function searchDrugs(query, forSuggestion = false) {
            if (!query) return [];
            
            const lowerQuery = query.toLowerCase();
            const results = drugsData.filter(drug => {
                const chineseName = (drug.chinese_name || '').toLowerCase();
                const englishName = (drug.english_name || '').toLowerCase();
                const clinicalApp = (drug.clinical_application || '').toLowerCase();
                
                return chineseName.includes(lowerQuery) || 
                       englishName.includes(lowerQuery) || 
                       clinicalApp.includes(lowerQuery);
            });
            
            return forSuggestion ? results : results.slice(0, 20);
        }

        // æ‰§è¡Œæœç´¢
        function performSearch() {
            const query = document.getElementById('searchInput').value.trim();
            
            if (!query) return;
            
            const results = searchDrugs(query);
            hideAutocomplete();
            
            if (results.length === 0) {
                showNoResults();
            } else if (results.length === 1) {
                displayDrugResult(results[0]);
            } else {
                displayMultipleResults(results);
            }
        }

        // æ˜¾ç¤ºè¯ç‰©è¯¦ç»†ä¿¡æ¯
        function displayDrugResult(drug) {
            const resultSection = document.getElementById('resultSection');
            
            const drugInfo = [
                { label: 'è¯ç‰©ä¸­æ–‡å', content: drug.chinese_name },
                { label: 'è¯ç‰©è‹±æ–‡å', content: drug.english_name },
                { label: 'ä¸´åºŠåº”ç”¨', content: drug.clinical_application },
                { label: 'è‚¾åŠŸèƒ½æ­£å¸¸æ—¶çš„å‰‚é‡', content: drug.normal_dosage },
                { label: 'è¯ä»£åŠ¨åŠ›å­¦', content: drug.pharmacokinetics },
                { label: 'è¯ç‰©ä»£è°¢', content: drug.drug_metabolism },
                { label: 'è‚¾åŠŸèƒ½å—æŸæ—¶çš„å‰‚é‡', content: drug.impaired_kidney_function_dosage },
                { label: 'è‚¾è„æ›¿ä»£æ²»ç–—æ—¶çš„å‰‚é‡', content: drug.renal_replacement_therapy_dosage },
                { label: 'é‡è¦çš„è¯ç‰©ç›¸äº’ä½œç”¨', content: drug.important_drug_interactions },
                { label: 'ç”¨æ³•', content: drug.usage },
                { label: 'å…¶ä»–ä¿¡æ¯', content: drug.other_information },
                { label: 'å‚è€ƒæ–‡çŒ®', content: drug.references }
            ];
            
            const infoGrid = drugInfo.map(info => `
                <div class="info-item">
                    <div class="info-label">${info.label}</div>
                    <div class="info-content">${info.content || 'æš‚æ— ç›¸å…³ä¿¡æ¯'}</div>
                </div>
            `).join('');
            
            resultSection.innerHTML = `
                <div class="drug-card">
                    <div class="drug-title">${drug.chinese_name || 'æœªçŸ¥è¯ç‰©'}</div>
                    <div class="drug-subtitle">${drug.english_name || ''}</div>
                    <div class="info-grid">
                        ${infoGrid}
                    </div>
                </div>
            `;
            
            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        // æ˜¾ç¤ºå¤šä¸ªæœç´¢ç»“æœ
        function displayMultipleResults(results) {
            const resultSection = document.getElementById('resultSection');
            
            const resultList = results.map(drug => `
                <div class="drug-card" onclick="displayDrugResult(drugsData.find(d => d.chinese_name === '${drug.chinese_name}'))" style="cursor: pointer;">
                    <div class="drug-title">${drug.chinese_name || 'æœªçŸ¥è¯ç‰©'}</div>
                    <div class="drug-subtitle">${drug.english_name || ''}</div>
                    <div class="info-content">ä¸´åºŠåº”ç”¨ï¼š${drug.clinical_application || 'æš‚æ— '}</div>
                </div>
            `).join('');
            
            resultSection.innerHTML = `
                <h2 style="margin-bottom: 20px; color: #333;">æœç´¢ç»“æœ (${results.length} ä¸ªè¯ç‰©)</h2>
                ${resultList}
            `;
            
            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        // æ˜¾ç¤ºæ— ç»“æœ
        function showNoResults() {
            const resultSection = document.getElementById('resultSection');
            
            resultSection.innerHTML = `
                <div class="no-results">
                    <div class="spinner"></div>
                    <h3>æœªæ‰¾åˆ°ç›¸å…³è¯ç‰©</h3>
                    <p>è¯·å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æœç´¢</p>
                </div>
            `;
            
            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>